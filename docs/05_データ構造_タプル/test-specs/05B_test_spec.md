# テスト仕様書: 05B_server_log_analysis

## 概要
サーバーログ解析機能のテスト仕様書（filter_successful_requests および count_requests_by_ip）

## 基本機能テスト

### No.1: filter_successful_requests - 基本動作
- **テスト概要**: ステータスコード200のリクエスト抽出
- **input**: `[("192.168.0.1","GET /index.html",200), ("192.168.0.2","POST /login",401), ("192.168.0.1","GET /about.html",200), ("192.168.0.3","GET /contact.html",404)]`
- **期待値**: `[("192.168.0.1","GET /index.html",200), ("192.168.0.1","GET /about.html",200)]`
- **テストの目的**: 成功ステータスの正確な抽出を確認

### No.2: count_requests_by_ip - 基本動作
- **テスト概要**: IPアドレス別リクエスト回数の集計
- **input**: `[("192.168.0.1","GET /index.html",200), ("192.168.0.2","POST /login",401), ("192.168.0.1","GET /about.html",200), ("192.168.0.3","GET /contact.html",404), ("192.168.0.1","POST /submit",500), ("192.168.0.2","GET /dashboard",200)]`
- **期待値**: `{"192.168.0.1":3, "192.168.0.2":2, "192.168.0.3":1}`
- **テストの目的**: IP別カウントの正確性を確認

### No.3: 複合動作テスト
- **テスト概要**: 両関数の組み合わせテスト
- **input**: サンプルログデータ
- **期待値**: 各関数の期待結果が正確に返される
- **テストの目的**: 両関数の独立性と正確性を確認

## エッジケーステスト

### No.4: 空ログでの処理
- **テスト概要**: 空のログリストでの処理
- **input**: `[]`
- **期待値**: filter_successful_requests: `[]`, count_requests_by_ip: `{}`
- **テストの目的**: 空データでの処理確認

### No.5: 200ステータスのみ
- **テスト概要**: 全てのリクエストが成功ステータス
- **input**: `[("192.168.0.1","GET /a",200), ("192.168.0.2","GET /b",200), ("192.168.0.3","GET /c",200)]`
- **期待値**: filter_successful_requests: 全ログ, count_requests_by_ip: 各IP 1回
- **テストの目的**: 全成功ケースでの処理確認

### No.6: 200ステータスなし
- **テスト概要**: 成功ステータスが存在しない場合
- **input**: `[("192.168.0.1","GET /a",404), ("192.168.0.2","GET /b",500), ("192.168.0.3","GET /c",401)]`
- **期待値**: filter_successful_requests: `[]`, count_requests_by_ip: 各IP 1回
- **テストの目的**: 成功ステータスなしでの処理確認

### No.7: 単一IPからの複数リクエスト
- **テスト概要**: 1つのIPから多数のリクエスト
- **input**: `[("192.168.0.1","GET /1",200), ("192.168.0.1","GET /2",404), ("192.168.0.1","GET /3",200), ("192.168.0.1","GET /4",500)]`
- **期待値**: filter_successful_requests: 2件, count_requests_by_ip: `{"192.168.0.1":4}`
- **テストの目的**: 単一IPでの処理精度

## 精度・境界値テスト

### No.8: 様々なステータスコード
- **テスト概要**: 多様なHTTPステータスコード
- **input**: `[("IP1","GET /",100), ("IP2","GET /",200), ("IP3","GET /",300), ("IP4","GET /",400), ("IP5","GET /",500)]`
- **期待値**: filter_successful_requests: ステータス200のみ, count_requests_by_ip: 各IP 1回
- **テストの目的**: ステータスコード判定の精度

### No.9: 特殊なリクエスト内容
- **テスト概要**: 長いパスや特殊文字を含むリクエスト
- **input**: `[("192.168.0.1","GET /very/long/path/with/many/segments?param=value",200), ("192.168.0.2","POST /api/v1/users/@123/update",200)]`
- **期待値**: filter_successful_requests: 両方含む, count_requests_by_ip: 各IP 1回
- **テストの目的**: 特殊リクエストでの処理確認

### No.10: IPv6アドレス
- **テスト概要**: IPv6アドレスでの処理
- **input**: `[("2001:db8::1","GET /index.html",200), ("2001:db8::2","GET /about.html",404)]`
- **期待値**: filter_successful_requests: IPv6の200のみ, count_requests_by_ip: 各IP 1回
- **テストの目的**: IPv6アドレスでの処理確認

## 特殊機能テスト

### No.11: 混合ステータスコードパターン
- **テスト概要**: 200と非200が混在するパターン
- **input**: `[("IP1","GET /",200), ("IP1","GET /",404), ("IP1","GET /",200), ("IP2","GET /",500), ("IP2","GET /",200)]`
- **期待値**: filter_successful_requests: 3件の200, count_requests_by_ip: IP1:3, IP2:2
- **テストの目的**: 混合パターンでの処理精度

### No.12: HTTPメソッドの多様性
- **テスト概要**: 各種HTTPメソッドでの処理
- **input**: `[("IP1","GET /",200), ("IP1","POST /",200), ("IP1","PUT /",200), ("IP1","DELETE /",200), ("IP1","PATCH /",200)]`
- **期待値**: filter_successful_requests: 全5件, count_requests_by_ip: IP1:5
- **テストの目的**: HTTPメソッド非依存の処理確認

### No.13: 順序保持の確認
- **テスト概要**: 元のログの順序が保持されるか
- **input**: 時系列順のログデータ
- **期待値**: filter_successful_requests: 元の順序を保持
- **テストの目的**: 順序保持の確認

## パフォーマンステスト

### No.14: 大規模ログ処理
- **テスト概要**: 大量のログデータでの処理性能
- **input**: `10000件のログデータ（様々なIP、ステータスコード）`
- **期待値**: 正確な処理結果（各関数処理時間2秒以内）
- **テストの目的**: 大規模データでの処理効率と正確性