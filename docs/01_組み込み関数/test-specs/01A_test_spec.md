# テスト仕様書: 01A_calc_cpk

## 概要
工程能力指数 (Cpk) 計算のテスト仕様書

## 基本機能テスト

### No.1: サンプルケース検証
- **テスト概要**: 問題文のサンプルケースを検証
- **input**: `usl=10.0, lsl=2.0, data=[4.5, 5.0, 4.8, 5.2, 5.5]`
- **期待値**: `2.626`
- **テストの目的**: 基本的なCpk計算ロジックの正確性を確認

### No.2: 最小データセット
- **テスト概要**: 単一データポイントでの計算
- **input**: `usl=5.0, lsl=1.0, data=[3.0]`
- **期待値**: `1.333` (標準偏差を0として扱う場合の代替計算)
- **テストの目的**: 標準偏差が0の場合の処理を確認

### No.3: 完全中央集中
- **テスト概要**: データが規格中心に完全に集中
- **input**: `usl=10.0, lsl=0.0, data=[5.0, 5.0, 5.0, 5.0, 5.0]`
- **期待値**: エラーまたは特別値 (標準偏差=0)
- **テストの目的**: 標準偏差が0の場合のエラーハンドリングを確認

## エッジケーステスト

### No.4: 極端にオフセンター
- **テスト概要**: プロセス平均が規格範囲の端に偏っている
- **input**: `usl=10.0, lsl=0.0, data=[9.8, 9.9, 9.7, 9.8, 9.9]`
- **期待値**: `0.133` (計算結果に基づく)
- **テストの目的**: 非対称度(k)が大きい場合の計算精度を確認

### No.5: 最小規格幅
- **テスト概要**: USLとLSLの差が最小の場合
- **input**: `usl=1.001, lsl=1.000, data=[1.0005, 1.0003, 1.0007, 1.0004, 1.0006]`
- **期待値**: 計算結果 (精度確認)
- **テストの目的**: 非常に狭い規格幅での計算精度を確認

### No.6: 最大規格幅
- **テスト概要**: USLとLSLの差が大きい場合
- **input**: `usl=1000.0, lsl=-1000.0, data=[0.0, 10.0, -5.0, 15.0, -10.0]`
- **期待値**: 計算結果 (大きな値)
- **テストの目的**: 大きな規格幅での計算の安定性を確認

### No.7: 負値を含むデータ
- **テスト概要**: データに負の値が含まれる場合
- **input**: `usl=0.0, lsl=-10.0, data=[-2.0, -3.0, -1.0, -4.0, -2.5]`
- **期待値**: 計算結果
- **テストの目的**: 負値データでの計算正確性を確認

## 精度・境界値テスト

### No.8: 四捨五入境界テスト
- **テスト概要**: 四捨五入の境界値での精度確認
- **input**: データを調整して結果が1.23445や1.23455になるケース
- **期待値**: `1.2345` (四捨五入結果)
- **テストの目的**: 小数点第4位での四捨五入の正確性を確認

### No.9: 極小標準偏差
- **テスト概要**: 標準偏差が非常に小さい場合
- **input**: `usl=2.0, lsl=1.0, data=[1.5, 1.500001, 1.499999, 1.500002, 1.499998]`
- **期待値**: 非常に大きなCpk値
- **テストの目的**: 極小標準偏差での計算安定性を確認

### No.10: 極大標準偏差
- **テスト概要**: 標準偏差が非常に大きい場合
- **input**: `usl=100.0, lsl=-100.0, data=[-50.0, 80.0, -30.0, 60.0, -70.0]`
- **期待値**: 非常に小さなCpk値
- **テストの目的**: 極大標準偏差での計算安定性を確認

## パフォーマンステスト

### No.11: 大規模データセット
- **テスト概要**: 大量データでの処理性能
- **input**: `usl=10.0, lsl=0.0, data=[正規分布に従う1000個のデータ]`
- **期待値**: 計算結果 (処理時間1秒以内)
- **テストの目的**: 大規模データセットでの処理効率を確認

### No.12: 超大規模データセット
- **テスト概要**: 極大データセットでの処理
- **input**: `usl=10.0, lsl=0.0, data=[正規分布に従う10000個のデータ]`
- **期待値**: 計算結果 (処理時間5秒以内)
- **テストの目的**: メモリ効率と処理速度の限界を確認

## 統計的妥当性テスト

### No.13: 理論値との比較
- **テスト概要**: 理論的に計算可能な分布での検証
- **input**: `usl=6.0, lsl=0.0, 平均3.0、標準偏差0.5の正規分布サンプル`
- **期待値**: 理論Cpk値との近似一致
- **テストの目的**: 統計的理論との整合性を確認

### No.14: ランダムデータ検証
- **テスト概要**: ランダムデータでの安定性
- **input**: `usl=20.0, lsl=0.0, data=[複数のランダムシードでの生成データ]`
- **期待値**: 一貫した計算結果
- **テストの目的**: アルゴリズムの堅牢性とランダムデータへの対応を確認